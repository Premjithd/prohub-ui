<div class="pending-jobs-container">
  <!-- Page Header -->
  <div class="page-header">
    <h1>My Jobs</h1>
    <p class="subtitle">Manage and track your posted jobs by status</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success">
    <mat-icon>check_circle</mat-icon>
    <span>{{ successMessage }}</span>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <mat-icon>error</mat-icon>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Status Filter -->
  <div *ngIf="!loading && allPendingJobs.length > 0" class="status-filter">
    <span class="filter-label">Filter by Status:</span>
    <mat-button-toggle-group 
      [value]="selectedStatusFilter" 
      (change)="onFilterChange($event.value)"
      class="status-toggle-group">
      <mat-button-toggle *ngFor="let status of statusFilters" [value]="status">
        {{ status }}
      </mat-button-toggle>
    </mat-button-toggle-group>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading your pending jobs...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && pendingJobs.length === 0" class="empty-state">
    <mat-icon class="empty-icon">work_off</mat-icon>
    <h2>No Jobs To Show</h2>
    <p>You can post new jobs by clicking the button below.</p>
    <button mat-raised-button color="primary" routerLink="/post-job">
      <mat-icon>add</mat-icon>
      Post a New Job
    </button>
  </div>

  <!-- Jobs List -->
  <div *ngIf="!loading && pendingJobs.length > 0" class="jobs-list-container">
    <mat-card class="jobs-list-card">
      <mat-card-header>
        <h2>My Jobs ({{ pendingJobs.length }})</h2>
      </mat-card-header>
      <mat-card-content>
        <table class="jobs-table">
          <thead>
            <tr>
              <th>Job Title</th>
              <th>Category</th>
              <th>Status</th>
              <!-- <th>Budget</th> -->
              <th>Progress</th>
              <!-- <th>Bids</th> -->
              <th class="actions">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let job of pendingJobs" class="job-row" [class.completed]="job.status === 'Completed'">
              <td class="title-cell">
                <strong>{{ job.title }}</strong>
              </td>
              <td>
                <span class="category-badge">{{ job.category?.name || 'Uncategorized' }}</span>
              </td>
              <td>
                <mat-chip-set>
                  <mat-chip [color]="getStatusColor(job.status)" selected size="small">
                    {{ job.status }}
                  </mat-chip>
                </mat-chip-set>
              </td>
              <!-- <td>
                {{ formatBudget(job.budget) }}
              </td> -->
              <td>
                <div class="progress-cell" *ngIf="job.status === 'In Progress'">
                  <mat-progress-bar 
                    mode="determinate" 
                    [value]="getJobPhaseProgress(job)"
                    color="accent">
                  </mat-progress-bar>
                  <span class="progress-percent">{{ getJobPhaseProgress(job) }}%</span>
                </div>
                <span *ngIf="job.status !== 'In Progress'" class="progress-na">â€”</span>
              </td>
              <!-- <td>
                <span class="bid-count">{{ (jobBidsMap.get(job.id) || []).length }} bid<span *ngIf="(jobBidsMap.get(job.id) || []).length !== 1">s</span></span>
              </td> -->
              <td class="actions">
                <button 
                  mat-raised-button 
                  class="view-button"
                  matTooltip="View Details"
                  (click)="viewJobDetails(job.id)">
                  <mat-icon>visibility</mat-icon>
                  View
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>

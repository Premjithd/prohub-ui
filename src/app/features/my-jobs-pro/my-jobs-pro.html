<div class="my-jobs-pro-container">
  <!-- Page Header -->
  <div class="page-header">
    <h1>My Assigned Jobs</h1>
    <p class="subtitle">View and manage jobs assigned to you</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="alert alert-success">
    <mat-icon>check_circle</mat-icon>
    <span>{{ successMessage }}</span>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-error">
    <mat-icon>error</mat-icon>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading your assigned jobs...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && assignedJobs.length === 0" class="empty-state">
    <mat-icon class="empty-icon">assignment</mat-icon>
    <h2>No Assigned Jobs</h2>
    <p>You don't have any jobs assigned to you yet. Check out available jobs and submit bids to get started!</p>
    <button mat-raised-button color="primary" routerLink="/available-jobs">
      <mat-icon>search</mat-icon>
      Browse Available Jobs
    </button>
  </div>

  <!-- Jobs List -->
  <div *ngIf="!loading && assignedJobs.length > 0" class="jobs-list-container">
    <!-- Status Filter -->
    <div class="status-filter">
      <span class="filter-label">Filter by Status:</span>
      <mat-button-toggle-group 
        [value]="selectedStatus" 
        (change)="onStatusFilterChange($event.value)"
        class="status-toggle-group">
        <mat-button-toggle *ngFor="let status of availableStatuses" [value]="status">
          {{ status }}
        </mat-button-toggle>
      </mat-button-toggle-group>
    </div>

    <mat-card class="jobs-list-card">
      <mat-card-header>
        <h2>Your Assigned Jobs ({{ filteredJobs.length }})</h2>
      </mat-card-header>
      <mat-card-content>
        <table class="jobs-table">
          <thead>
            <tr>
              <th>Job Title</th>
              <th>Category</th>
              <th>Status</th>
              <!-- <th>Budget</th> -->
              <!-- <th>Timeline</th> -->
              <th>Progress</th>
              <th class="actions">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let job of filteredJobs" class="job-row" [class.completed]="job.status === 'Completed'">
              <td class="title-cell">
                <strong>{{ job.title }}</strong>
              </td>
              <td>
                <span class="category-badge">{{ job.category?.name || 'Uncategorized' }}</span>
              </td>
              <td>
                <mat-chip-set>
                  <mat-chip [color]="getStatusColor(job.status)" selected size="small">
                    {{ job.status }}
                  </mat-chip>
                </mat-chip-set>
              </td>
              <!-- <td>
                {{ formatBudget(job.budget) }}
              </td> -->
              <!-- td>
                {{ formatTimeline(job.timeline) }}
              </td> -->
              <td>
                <div class="progress-cell">
                  <mat-progress-bar 
                    mode="determinate" 
                    [value]="getPhaseProgress(job)"
                    color="accent">
                  </mat-progress-bar>
                  <span class="progress-percent">{{ getPhaseProgress(job) }}%</span>
                </div>
              </td>
              <td class="actions">
                <button 
                  mat-raised-button 
                  class="view-button"
                  matTooltip="View Details"
                  (click)="viewJobDetails(job.id)">
                  <mat-icon>visibility</mat-icon>
                  View
                </button>
                <button 
                  mat-raised-button 
                  color="accent"
                  matTooltip="Mark Completed"
                  *ngIf="job.status !== 'Completed'"
                  (click)="markAsCompleted(job.id)">
                  <mat-icon>check_circle</mat-icon>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>

